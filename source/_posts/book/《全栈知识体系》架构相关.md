---
title: 《全栈知识体系》架构相关
categories:
  - 猿阅读
tags:
  - 架构
date: 2024-04-22 00:09:50
---

本文是学习[Java全栈知识体系](https://www.pdai.tech/)的一个梳理，还得优化一下思路和语言。

# 复杂度来源

**架构图**：理清组件和组件之间的关系

Eric Evans 在 Domain‐Driven Design 一书中吐槽了所谓的意大利面式架构，即代码确实做了有用的事，但很难解释它是如何去执行的；他认为造成这种窘境的主要原因是，**将领域问题的复杂度与技术细节的复杂度混合在了一起，最终导致整体复杂度的指数级增长**。

![img](https://spumetime-blog.oss-cn-shenzhen.aliyuncs.com/img/20250611023054514.png)

理解**架构的视角**、**架构的分层**、**架构的演进**、**架构的服务演化**。



# 大型网站七层逻辑架构：![img](https://spumetime-blog.oss-cn-shenzhen.aliyuncs.com/img/20250611023054610.png)

以上采用七层逻辑架构，第一层客户层，第二层前端优化层，第三层应用层，第四层服务层，第五层数据存储层，第六层大数据存储层，第七层大数据处理层。

客户层：减少Http请求数，浏览器缓存，启用压缩，Js异步，减少Cookie传输；

前端层：DNS负载均衡，CDN本地加速，反向代理服务；

应用层：业务拆分；负载均衡，分级管理，应用缓存，服务集群，快速失败，异步调用，服务降级，消息队列，幂等设计等。

服务层：提供公用服务，比如用户服务，订单服务，支付服务等；

数据层：分布式, 数据库集群，读写分离，NOSQL集群，文件系统集群；分布式缓存；冗余备份（冷，热备[同步，异步]，温备），失效转移（确认，转移，恢复）。CAP理论，一致性算法。

大数据存储层：支持应用层和服务层的日志数据收集，关系数据库和NOSQL数据库的结构化和半结构化数据收集；

大数据处理层：通过Mapreduce进行离线数据分析或Storm实时数据分析，并将处理后的数据存入关系型数据库。（实际使用中，离线数据和实时数据会按照业务要求进行分类处理，并存入不同的数据库中，供应用层或服务层使用）。



# 理解架构的演进

推荐阅读：作者的知识总结全部来自《大型网站技术架构》，我看过大致流程记得。从这里看到单元化部署的扩展知识，推荐阅读：[什么是单元化原理,如何实现单元化_金融分布式架构(SOFAStack)-阿里云帮助中心](https://help.aliyun.com/document_detail/159741.html)

# 架构模式

作者摘自：[朱晔的互联网架构实践心得S1E7：三十种架构设计模式（上） - lovecindywang - 博客园](https://www.cnblogs.com/lovecindywang/p/9670356.html)

朱晔在极客时间上也有课《Java业务开发常见错误100例》

- 管理和监控

- 1、大使模式：创建代表消费者服务或应用程序发送网络请求的帮助服务
- 2、反腐模式：在现代应用程序和遗留系统之间实现装饰或适配器层
- 3、外部配置存储：将应用程序部署包中的配置信息移动到中心化的位置
- 4、网关聚合模式：使用网关将多个单独的请求聚合到一个请求中
- 5、网关卸压模式：把共享或特定的服务功能放到网关代理
- 6、网关路由模式：使用单个端点将请求路由到多个服务
- 7、健康端点监控模式：在应用程序中执行功能检查，外部工具可以定期通过暴露的端点访问
- 8、绞杀者模式：通过使用新的应用程序和服务逐渐替换特定功能部件来逐步迁移旧系统

- 性能和可扩展性

- 9、缓存辅助模式：按需将数据从数据存储加载到缓存中
- 10、命令和查询责任分离模式：通过使用单独的接口来分离读取数据和更新数据的操作
- 11、事件溯源模式：使用仅追加存储去记录描述对域中的数据采取的操作的完整系列事件
- 12、物化视图模式：针对所需的查询操作，当数据没有理想地格式化时，在一个或多个数据存储中的数据上生成预填充视图
- 13、基于队列的负载均衡模式：使用一个队列作为任务和服务之间的缓冲区，平滑间歇性重负载
- 14、优先级队列模式：确定发送到服务的请求的优先级，使得具有较高优先级的请求更快地被接收和处理
- 15、限流模式：控制应用程序，个人租户或整个服务的实例消耗的资源

- 数据管理模式

- 16、分片模式：将数据存储区划分为一组水平分区或分片
- 17、静态内容托管模式：将静态内容部署到基于云的存储服务，可以将它们直接传递给客户端
- 18、索引表模式：为查询经常引用的数据存储区中的字段创建索引

- 设计和实现模式

- 19、前端专用的后端模式：通过使用单独的接口来分离读取数据和更新数据的操作
- 20、计算资源整合模式：将多个任务或操作整合到单个计算单元中
- 21、选举模式：通过选举一个实例作为负责管理其它实例的负责人，来协调分布式应用程序中的协作任务实例集合执行的操作
- 22、管道和过滤器模式：将需要执行复杂处理的任务分解成可以重复使用的一系列单独的元素

- 消息模式

- 23、竞争消费者模式：使用多个并发消费者来处理在同一消息通道上接收的消息
- 24、重试模式：在应用程序尝试连接到服务或网络资源遇到预期的临时故障时，让程序通过透明地重试以前失败的操作来处理
- 25、调度、代理、主管模式：在一组分布式服务和其它远程资源之间协调一组操作

- 弹性模式

- 26、舱壁模式：将应用程序的元素隔离到池中，如果其中一个失败，其它的将继续运行
- 27、断路器模式：连接到远程服务或资源时, 处理可能需要花费时间来修复的故障
- 28、事务补偿模式：撤消通过一系列步骤执行的工作，它们一起定义最终一致的操作

- 安全模式

- 29、代客密钥模式：使用向客户端提供对特定资源或服务的有限直接访问权限的令牌或密钥
- 30、联合身份模式：将认证委托给外部身份提供者

# 技术架构的核心要素

性能

可用性

伸缩性

扩展性

安全性
